<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Libketama-c by bisegni</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Libketama-c</h1>
      <h2 class="project-tagline">&quot;C&quot; only implementation of ketama lib (https://github.com/RJ/ketama) using api for adding server instead of file (remove_server will be added in the future).</h2>
      <a href="https://github.com/bisegni/libketama-c" class="btn">View on GitHub</a>
      <a href="https://github.com/bisegni/libketama-c/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/bisegni/libketama-c/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <p>"c" only implementation of ketama lib (<a href="https://github.com/RJ/ketama">https://github.com/RJ/ketama</a>) using
api for adding server instead of file.</p>

<p>The repository now has only an xcode project, in future will be added more compilaiton types.
Anyway the files libketama/ketama.c and libketama/md5.c compile also on linux and probably on window.
Only ketama.c has been update to expose new api and structure.</p>

<p>"C" Example:</p>

<div class="highlight highlight-source-c++"><pre><span class="pl-c1">ketama_t</span> ktma;
<span class="pl-en">ketama_init</span>(&amp;ktma);
<span class="pl-en">ketama_add_server</span>(&amp;ktma, <span class="pl-s"><span class="pl-pds">"</span>192.168.1.1:11211<span class="pl-pds">"</span></span>, <span class="pl-c1">60</span>);
<span class="pl-en">ketama_add_server</span>(&amp;ktma, <span class="pl-s"><span class="pl-pds">"</span>192.168.1.2:11211<span class="pl-pds">"</span></span>, <span class="pl-c1">30</span>);
<span class="pl-en">ketama_add_server</span>(&amp;ktma, <span class="pl-s"><span class="pl-pds">"</span>192.168.1.3:11211<span class="pl-pds">"</span></span>, <span class="pl-c1">10</span>);

<span class="pl-en">ketama_update_continuum</span>(&amp;ktma);

<span class="pl-en">ketama_print_continuum</span>(&amp;ktma);

<span class="pl-k">int</span> i;
<span class="pl-k">for</span> ( i = <span class="pl-c1">0</span>; i &lt; <span class="pl-c1">1000000</span>; i++ ) {
  <span class="pl-k">char</span> k[<span class="pl-c1">10</span>];
  <span class="pl-c1">sprintf</span>( k, <span class="pl-s"><span class="pl-pds">"</span>%d<span class="pl-pds">"</span></span>, i );
  <span class="pl-k">unsigned</span> <span class="pl-k">int</span> kh = <span class="pl-c1">ketama_hashi</span>( k );
  mcs* m = <span class="pl-c1">ketama_get_server</span>(&amp;ktma, k);

  <span class="pl-c1">printf</span>( <span class="pl-s"><span class="pl-pds">"</span>hash:%u Continuum point:%u Host:%s<span class="pl-cce">\n</span><span class="pl-pds">"</span></span>, kh, m-&gt;point, m-&gt;ip );
}
<span class="pl-en">ketama_destroy</span>(&amp;ktma);</pre></div>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/bisegni/libketama-c">Libketama-c</a> is maintained by <a href="https://github.com/bisegni">bisegni</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
